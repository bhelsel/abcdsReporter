% load packages
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{fancyhdr}
\usepackage{sectsty}
\usepackage{fontspec}
\usepackage{titlesec}

\geometry{a4paper, total={170mm,257mm}, top=20mm, bottom=20mm, left=50mm, right=20mm}

%% Let's define some colours
\definecolor{abcdsblue}{HTML}{1267FF}
\definecolor{codeblock}{HTML}{E6E6FA}
\definecolor{highlight}{HTML}{800080}
\definecolor{abcdsnavy}{HTML}{001B44}

\AtBeginDocument{%
    \AddToShipoutPicture*{%
         % Logo
        \AtPageLowerLeft{%
            \put(\LenToUnit{\dimexpr\paperwidth-145mm}, 24.2cm){%
            \color{abcdsnavy}\includegraphics{_extensions/abcds/logos/abcds_logo.png}
            }%
        }%
    }
}

%% Let's add the border on the right hand side and the logo in the top right corner
\AddToShipoutPicture{%
    % Right bar
    %\restoregeometry
    \AtPageLowerLeft{%
        \put(\LenToUnit{\dimexpr\paperwidth-210mm}, 0){%
            \color{abcdsnavy}\rule{3cm}{\LenToUnit\paperheight}%
        }%
    }%
}

%% Style the page number
\fancypagestyle{abcds}{
  \fancyhf{}
  \renewcommand\headrulewidth{0pt}
  \fancyfoot[L]{
    \textcolor{white}{
        \fontsize{16}{16}\selectfont
        \thepage
        }
  }
  \fancyfootoffset[L]{3.5cm}
  \fancyfoot[R]{%
        \textcolor{abcdsnavy}{%
            \fontsize{10}{8.4}\selectfont%
            \textsc{ABC-DS Internal Report} \textcolor{abcdsblue}{|} \today%
        }%
  }
}
\setlength{\footskip}{20pt}

%% style the chapter/section fonts
\chapterfont{\color{abcdsblue}\fontsize{20}{16.8}\selectfont}
\sectionfont{\color{abcdsblue}\fontsize{20}{16.8}\selectfont}
\titleformat{\subsection}
    {\color{abcdsblue}\sffamily\fontsize{14}{16.8}\selectfont\bfseries}
    {\thesection}{1em}{}[{\color{black}\titlerule[1.5pt]}]
